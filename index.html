<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles/index.css">
    <title>Stand Up</title>
</head>
<body>
    <div  class="signin">
        <div class="form-bg">
            <div class="header">
            <h1 class="title">Login</h1>
            <p class="subtitle">Please enter your credentials</p>
            </div>
    
            <form action="/" method="POST" class="form" id="loginForm">
                <div class="form-item">
                    <input type="name" id="name" name="name" placeholder="name" class="input" required>
                </div>
                <div class="form-item">
                    <input type="cell" id="cell" name="cell" placeholder="cell" class="input" required>
                </div>
    
            <button type="submit" class="button">Sign in</button>
            </form>
    
        </div>
    </div>
    <script>
        const loginForm = document.getElementById('loginForm');

        loginForm.addEventListener('submit', async (event) => {
            event.preventDefault();
            
            const name = document.getElementById('name').value;
            const cell = document.getElementById('cell').value;

            try {
                const response = await fetch('https://stand-up-teal.vercel.app/auth/login', {
                    mode: "cors",
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Access-Control-Allow-Methods': "*"
                    },
                    body: JSON.stringify({ name, cell })
                });
                console.log("response: ",response)

                if (!response.ok) {
                    throw new Error('Login failed');
                }

                const data = await response.json();

                localStorage.setItem('user', JSON.stringify(data));

                window.location.href = 'groups.html';
            } catch (error) {
                console.error('Failed to login:', error);
                alert('Invalid credentials. Please try again.');
            }
        });
    </script>
</body>
</html>